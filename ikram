#include <stdio.h>
#include <stdlib.h>
#include<string.h>
#include <stdbool.h>
//#using namespace std;
typedef struct node{
char word [20];
int *tab ;
struct node *left;
struct node *right;
} node;


//-------------------------------------------------------------------------------------------------------------------------------
//----------------------fonction qui recherche si un mot existe deja dans l'arbre--------------------------------------------------
//---------------------------------------------------------------------------------------------------------------------------------


  bool trouver(char *mot , node *tr ) {
   if(tr == NULL){
   //------------------- le cas ou l'arbre est vide----------
    return false ;
	}
       //------------ le cas ou le mot existe deja dans l'arbre-------------
    if(strcmp(mot ,tr->word)== 0){
            // mot = tr->word
    return true;
    }else {
	// le cas ou le mot  n'existe pas {la racine } on teste s'il exist dans les noeuds

    if(strlen (mot) <  strlen(tr->word)){

	return trouver(mot, tr -> left);	// si la taille (mot ) < taille (tr -> word) on cherhche dans le fils gauche
    }else{

    return trouver(mot, tr-> right); // si la taille (mot ) > taille (tr -> word) on cherhche dans le fils droite
}}}





//--------------------------------------------------
//-------------allocation d'un noued ---------------
//--------------------------------------------------
node *allouer(char *word){
	node *nouv= (node*)malloc(sizeof(node));
    strcpy( nouv->word , word);
    nouv->left = NULL;
    nouv->right = NULL;
	nouv->tab =(int *)malloc (100*sizeof(int));// tableau dynamique tab[100]
    return nouv ;
}

//----------------------------------------------------------------------------
//-----------------------------------insertion--------------------------------
//----------------------------------------------------------------------------

node* insertion(node *tr, char *mot, int i,int cpt  ){

	//----------le cas ou l'arbre vide---------
    if (tr == NULL) {
    tr = allouer( mot); // allocation
	tr->tab[i] =cpt ;
	return tr ;
    }else{ if(trouver(mot , tr )==true){
                // il y pas d'insertion

               tr->tab[i] =cpt ;
               return tr ;
        }else { if (strlen(tr->word) > strlen(mot)){
                // ----------------existe un traitment --------------
                // le cas d'insertion

                tr->right = insertion (tr->right,mot, cpt,i); // R->mot > mot => fils droite{
		        return tr ;
		       }else {
		 // tr->mot <= mot => fils gauche
            tr->left =	insertion (tr->left,mot,cpt, i);
            return tr ;
		}}


		}
    }


//-------------------------------------------------------------------------------------------------------------------------------------------------------------------
//------------------------------------------------------------------------------affichage----------------------------------------------------------------------------
//--------------------------------------------------------------------------------------------------------------------------------------------------------------------
void prefixe (node *R){
   int i ; int cpt ;
	if (R==NULL){
		return ;
	}else {
		printf(" le mot  est : %s \n",R->word);
		for (i=0; i<3 ; i++){
            printf("les positions des mots : %d , \n ", R->tab[i] );
		}
		//cpt++;
		prefixe(R->left);
		prefixe(R->right);
	}
}


//si le mot existe dans l'arbre on ajoute le numero de la phrase dans le tableau
//s'il n existe pas on insere le mot dans l arbre et on ajoute le numero de la phrase dans le tableau du mot

/*if (trouver(s,tr,num)==true ) //retourne rien
else return //FONCTION DE L'INSERTION*/

//-----------------------------------------------------------------------------------------------------------------------------------------------------
int main(){


 FILE *F ;
 node *R;
 F =fopen("TPASD.txt","r");

 //-----tester si le fichier est bien ouvert
 if(F ==NULL) {
 	printf("not open");
 	return ;
 }
 R= NULL ;
 char mot [10] ;
 int  cpt =1;
int i =0;
 while(!feof(F)){
 fscanf(F,"%s",mot);
       //le cas ou le mot ='.' alors o fait rien
           if (strcmp(mot ,".")==0){

            cpt++;// num de la phrase

           }else{

            R= insertion (R , mot,cpt,i);

            }
 }
prefixe (R);

 fclose(F);

  }


























